<!doctype html>
<html class="a">
 <head>
  <title>GainNode IDL Test</title>
  <script src="/resources/testharness.js"></script>
  <script src="/resources/testharnessreport.js"></script>
  <script src="/resources/idlharness.js"></script>
  <script src="/resources/webidl2/lib/webidl2.js"></script>
  <script src="/webaudio/js/lodash.js"></script>
  <script src="/webaudio/js/vendor-prefixes.js"></script>
  <script src="/webaudio/js/helpers.js"></script>
  <script src="/webaudio/js/jquery-2.0.3.min.js"></script>

  <style type="text/css">
  </style>
 </head>
 <body class="a">
   <div id="log"></div>

  <script>
(function() {
  var idl_array = new IdlArray();
  var idls = ['event-target-idl', 'audio-context-idl', 'audio-node-idl', 'audio-param-idl', 'gain-node-idl'];

  var getIDL = function(idl_id) {
    return jQuery.ajax('/webaudio/idl/' + idl_id, {dataType: 'text'});
  };

  var addIDL = function(idl_id) {
    var deferred = jQuery.Deferred();

    getIDL(idl_id).then(function(data) {
      if (idl_id == 'gain-node-idl') {
        idl_array.add_idls(data);
      } else {
        idl_array.add_untested_idls(data);
      }
      deferred.resolve();
    });

    return deferred.promise();
  };

  var idl_requests = _.map(idls, addIDL);

  jQuery.when.apply(jQuery, idl_requests).done(function() {
    gain_node = (new AudioContext).createGain();
    idl_array.add_objects({GainNode: ["gain_node"]});
    idl_array.test();
  });
})();
  </script>
 </body>
</html>
